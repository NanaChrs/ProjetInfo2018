<!-- affichage de l'heure -->
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8"/>
		<title> affichage réveil</title>
		<script type="text/javascript" src="semantic-UI-CSS-master/semantic.min.js"></script>
		<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    	<script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/signalr/jquery.signalr-2.2.2.min.js"></script>
    	<script type="text/javascript" src="https://cdn.myconstellation.io/js/Constellation-1.8.2.min.js"></script>
    	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
    	<script type="text/javascript" src="https://cdn.myconstellation.io/js/ngConstellation-1.8.2.min.js"></script>
    	<link rel="stylesheet" href="style.css"/> <!-- nécessite de créer un nouveau fichier CSS qui donnera les correspondances en CSS de notre code) -->
		<link rel="stylesheet" href="semantic-UI-CSS-master/semantic.min.css"/>
	</head>
	<body ng-controller="MyController">
		<script type="text/javascript">
		var temps;
		var adresse;
		var constellation = $.signalR.createConstellationConsumer("http://localhost:8088", "123456789", "Test API JS");
		constellation.connection.start();
		constellation.connection.stateChanged(function (change) {
    		if (change.newState === $.signalR.connectionState.connected) {
        		console.log("Je suis connecté");
        		constellation.client.registerStateObjectLink("DESKTOP-CI66GL2", "DayInfo", "NameDay", "*", function (so) {
            console.log(so);
            $("#InfoName").text(so.Value);
    		});


    		constellation.client.registerStateObjectLink("DESKTOP-CI66GL2", "DayInfo", "SunInfo", "*", function (so) {
            console.log(so);
            var d = new Date(so.Value.Date);
            $("#year").text(d.getFullYear());
            var mois=d.getMonth()+1;
            $("#month").text((mois<10?'0':'')+mois);
            $("#day").text((d.getDate()<10?'0':'')+d.getDate());
    	});

    		constellation.client.registerStateObjectLink("DESKTOP-CI66GL2", "GoogleCalendar", "Events", "*", function (so) {
            	$("#AgendaNom").text(so.Value[0].Nom);
            	$("#DateDebut").text(so.Value[0].DateDebut);
            	$("#DateFin").text(so.Value[0].DateFin);
            	$("#Lieu").text(so.Value[0].Lieu);
            	var lieu=so.Value[0].Lieu;
            	if (lieu==null){
            		lieu="ISEN Lille";
            	}

            	constellation.server.sendMessageWithSaga(function(response){
				lat=response.Data.latitude;
				lng=response.Data.longitude;
				constellation.server.sendMessageWithSaga(function(reponse){
					console.log(reponse.Data.currently);
					var degre=Math.round(reponse.Data.currently.apparentTemperature);
					$("#Temperature").text(degre);
					var png=reponse.Data.currently.icon;
					document.getElementById("icon").src="images/"+png+".png";
					
					
				},{Scope:'Package',Args:['ForecastIO']},'GetWeatherForecast',lng,lat);

			}, {Scope:'Package', Args:['GeocodingApi']},'CoordoneesGPS',lieu)})
            	
         }});
			;
;
	  EnableAuto = function(val){
	  	var modeauto=document.getElementById("modeauto");

	  	if(val.checked==true){
	  		modeauto.disabled=false;
	  	}
	  	else{
	  		modeauto.disabled=true;
	  		modeauto.checked=false;
	  	}
	  }

	  function hide() {
    var x = document.getElementById("HideTime");
    console.log("je ne suis pas caché è_é")
    if (x.style.display === "none") {
        x.style.display = "block";
    } else {
        x.style.display = "none";
    }
}
</script>

<div id="page1">
		<div id="div_horloge">
			<script type="text/javascript">
				window.onload=function() {
	  				horloge('div_horloge');
				};
	 
				function horloge(el) {
	  				if(typeof el=="string") { el = document.getElementById(el); }
	  				function actualiser() {
	    				var date = new Date();
	    				var str = date.getHours();
	    				str += ':'+(date.getMinutes()<10?'0':'')+date.getMinutes();
	    				el.innerHTML = str;
	  				}
	  				actualiser();
	  				setInterval(actualiser,1000);
				}
			</script>
		</div>
	<a href="#page2"><img src="images/next.png" id="next1"/></a>
</div>


<div id="page2">
	<a href="#page1"><img src="images/back.png"/></a>
	<div id="Infodujour">	
		<div>
		<span id="day"></span>/<span id="month"></span>/<span id=year ></span>
		</div>
	<div id="InfoName"></div>
	<div id="Meteo">
		<div>
		<span id="Temperature"></span>°C
	</div>
		<div><img src="" id="icon"/></div>
	</div>
	</div>
	<div id="Agenda">
		<h3> Prochain rendez-vous :</h3>
		<div id="AgendaNom"></div>
		<div id="DateDebut"></di>
		<div id="Lieu"></div>
		
	</div>

</div>
<a href="#page3"><img src="images/next.png" /></a>
</div>

<div id="page3">
	<div><a href="#page2"><img src="images/back.png"/></a></div>
	<div>
	<h3>Paramètres :</h3>


	<form method="post" action="traitement.php" id="formulaire" class>
	<div class="ui toggle checkbox">
		<input type="checkbox" name="activation" id="activation" onClick="EnableAuto(this)">
		<label>Activer le réveil</label>
	</div></br>
	<div class="ui toggle checkbox">
		<input type="checkbox" name="modeauto" id="modeauto" onClick="hide()">
		<label>Activer le mode automatique</label>
	</div></br>
	<div id="HideTime"><label> <strong>Veuillez entrer l'heure prévue du prochain réveil: </strong></label> <input type="time" id="time"/> </div>


	<div class="ui form">
  <div class="inline fields">
    <label>Que voulez-vous afficher ?</label>
    <div class="field">
      <div class="ui checkbox">
        <input type="checkbox" name="choix_meteo">
        <label>Météo</label>
      </div>
    </div>
    <div class="field">
      <div class="ui checkbox">
        <input type="checkbox" name="choix_agenda">
        <label>Agenda</label>
      </div>
    </div>
    <div class="field">
      <div class="ui checkbox">
        <input type="checkbox" name="choix_fete">
        <label>Fête du jour</label>
      </div>
    </div>
    <div class="field">
      <div class="ui checkbox">
        <input type="checkbox" name="choix_date">
        <label>Date du jour</label>
      </div>
    </div>
    <div class="field">
      <div class="ui checkbox">
        <input type="checkbox" name="choix_traffic">
        <label>Info traffic</label>
      </div>
    </div>
  </div>
</div>
<div class="ui primary submit button">Valider</div>
	</form>
</div>
</div>

</body>
</html>



